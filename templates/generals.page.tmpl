{{ template "base" .}}

{{ define "content" }}

    <div class="container">

        <div class="row">
            <div class="col-md-6 offset-md-3">
                <img class="img-fluid img-thumbnail mx-auto d-block" src="/static/images/generals-quarters.png" alt="General's Quarters">
            </div>
        </div>

        <div class="row">
            <div class="col">
                <h1 class="text-center mt-4">General's Quarters</h1>
                <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Numquam adipisci a, sequi ipsa nihil, laborum harum non ab quos dicta nesciunt voluptate at quasi dolorum cumque suscipit architecto odit, fugiat ducimus! Labore vitae modi facere laboriosam, illum hic consectetur quisquam odio repudiandae cum, eveniet non iusto quaerat! Saepe, perferendis. Est?</p>
            </div>
        </div>
    </div>
    <div class="container ">
        <div class="row">
            <div class="col text-center">
                <a id="check-availability-button" href="#!" class="btn btn-success">Check Availability</a>
            </div>
        </div>
    </div>

{{ end }}

{{ define "js"}}

    <script>
        document.getElementById("check-availability-button").addEventListener("click", () => {
            let html = `
                <form id="check-availability-form" action="" method="post" novalidate class="needs-validation">
                    <div class="form-row">
                        <div class="col">
                            <div class="form-row" id="reservation-dates-modal">
                                <div class="col">
                                    <input disabled required class="form-control" type="text" name="start" id="start" placeholder="Arrival">
                                </div>

                                <div class="col">
                                    <input disabled required class="form-control" type="text" name="end" id="end" placeholder="Departure">
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            `;

            // Create a custom modal
            attention.custom({ 
                title: 'Choose your dates', 
                msg: html,
                willOpen: () => {
                    const elem = document.getElementById("reservation-dates-modal");
                    const rp = new DateRangePicker(elem, {
                        format: 'yyyy-mm-dd',
                        showOnFocus: true,
                    })
                },
                didOpen: () => {
                    document.getElementById("start").removeAttribute("disabled");
                    document.getElementById("end").removeAttribute("disabled");
                },
                callback: (result) => {
                    // Once the modal is closed

                    console.log("called");

                    let form = document.getElementById("check-availability-form");
                    let formData = new FormData(form);
                    formData.append("csrf_token", "{{.CSRFToken}}"); // Add the CSRF token dynamically

                    // Get the data, convert it to JSON, and POST it
                    fetch("/search-availability-json", {
                        method: "POST",
                        body: formData
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log(data);
                    });
                }
            });
        });
    </script>

{{ end }}
